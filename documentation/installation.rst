.. dp_ml documentation master file, created by
   sphinx-quickstart on Tue Dec 12 09:58:51 2017.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

installation guide
=================================

.. image:: /figures/dp_ml_logo.png
   :align: center

personal computer
-------------------

We recommend that you use Python 3.5 and above. 
dp_ml depends on several packages. 
Please install these first:

   - `tensorflow <https://www.tensorflow.org/install/>`_
   - `scikit-learn <http://scikit-learn.org/stable/install.html>`_
   - `h5py <http://docs.h5py.org/en/latest/build.html>`_

We use several other packages. These can be installed by running the following commands:

.. code-block:: sh
	
	pip install tensorflow-gpu
	pip install scikit-learn
	pip install h5py
	pip install seaborn
	pip install scipy
	pip install h5py
	pip install matplotlib

Note that if your computer does not have a GPU, tensorflow is installed with :code:`pip install tensorflow`.

When ready, then run the following command to install dp_ml:

.. code-block:: sh
   
   pip install dielectric_estimation_ml

Next, download the data we have generated.
You can also generate your own data using your simulation software if you would prefer (see the Tutorial section).
The filesize is quite large (~700 MB).
The data can be downloaded from `here <https://www.davidgarrett.ca/dielectric_estimation_ml/data/dp_ml_data.hdf5>`_.
Store it in a convenient location, remembering the file path.

Now we can assign some user parameters.
Find the path where the package was installed by running:

.. code-block:: sh 

	python
	>>> import site; site.getsitepackages()

Navigate to this folder, then in a text editor, open the file :code:`config.py`, which is located in the dp_ml folder.
Here are user file paths for Windows, Mac and Linux.
Change the file paths corresponding to your system only.
This was done so you can work on multiple systems without having to change the file path each time.

- :code:`HDF5Path` corresponds to the path to the file you just downloaded (or to the folder you will fill with your own data).
- :code:`HDF5Filename` corresponds to the path to the name of this file.
- :code:`dataPath` and :code:`calPath` correspond to the folders where you store the raw data generated by your simulation tool. These are only necessary to assign if you plan on generating your own data. For instance, we use Sim4Life which will output S-parameters in .xls files. 

Finally, perform a test of the installation by running:

.. code-block:: sh

	python
	>>> import dp_ml
	>>> dp_ml.test_dpml

computing cluster
------------------

For improved performance, it is also possible to install this package on computing clusters such as those of Compute Canada or WestGrid.
Once you have an account on your desired platform, follow the steps below.

First get a working virtual environment for Python.
Check which versions of Python are available on your machine:

.. code-block:: sh

        module avail python

It is recommended to install versions of Python 3.5 and up.
Load the module using:

.. code-block:: sh

        module load python/3.5.4

In your home directory (or any other desired directory) run:

.. code-block:: sh

	virtualenv ENV
	source ENV/bin/activate

where ENV is the desired name for your virtual environment (I called mine tensorflow).

Now install tensorflow for use with GPU, and the other required packages:

.. code-block:: sh

	pip install tensorflow-gpu
	pip install scikit-learn
	pip install seaborn
	pip install scipy
	pip install h5py
	pip install matplotlib

Next, install the dp_ml package:

.. code-block:: sh

        pip install dielectric_estimation_ml

Then use a secure file transfer protocol (SFTP) program like PuTTY or CyberDuck to transfer the data file to the server.
Follow the same steps as above to configure and test the installation.
